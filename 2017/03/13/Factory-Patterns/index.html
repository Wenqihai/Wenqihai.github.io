<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="google-site-verification" content="" />
  
  <title>理解设计模式——工厂模式</title>
  <meta name="author" content="Vachel">
   <meta name="description" content="C# Developer">
  

  <meta property="og:title" content="理解设计模式——工厂模式"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:site_name" content="Vachel&#39;s blog"/>
 <meta property="og:image" content="undefined"/>
  
  <link href="/apple-touch-icon-precomposed.png" sizes="180x180" rel="apple-touch-icon-precomposed">
  <link rel="alternate" href="/atom.xml" title="Vachel&#39;s blog" type="application/atom+xml">
  <link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="/css/m.min.css">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
</head>

<body>
  <a id="top"></a>
  <div id='wx_pic' style='display:none;'><img src='/wx_share.png'/></div>
  <div id="main">
    <div class="behind">
      <div class="back">
        <a href="/" class="black-color"><i class="fa fa-times" aria-hidden="true"></i></a>
      </div>
      <div class="description">
        &nbsp;Enjoy coding...
      </div>
    </div>
    <div class="container">
      

  <article class="standard post">
    <div class="title">
      
  
    <h1 class="page-title center">
        理解设计模式——工厂模式
    </h1>
  


    </div>
    <div class="meta center">
      
<time datetime="2017-03-12T17:00:00.000Z">
  <i class="fa fa-calendar"></i>&nbsp;
  2017-03-13
</time>



    
    &nbsp;
    <i class="fa fa-tag"></i>&nbsp;
    <a href="/categories/总结/">总结</a>




    
    &nbsp;
    <i class="fa fa-tag"></i>&nbsp;
    <a href="/tags/设计模式/">设计模式</a>·<a href="/tags/Design-Patterns/">Design Patterns</a>


    </div>
    <hr>
    <div class="picture-container">
      
    </div>
    <p>设计模式算是一个古老的话题了，谈到OOP就不得不讲设计模式，通俗的讲，设计模式就是大量实践后总结出来的，利于构建松耦合、易扩展、高复用系统的编码套路。<br>本文介绍的是工厂模式，参考书是<a href="https://book.douban.com/subject/2243615/" target="_blank" rel="external">《Head First 设计模式》</a>，很好的一本书，看第一遍是在2年前，现在重新刷一遍，，总结一下。</p>
<h2 id="从简单工厂开始（Simple-Factory）"><a href="#从简单工厂开始（Simple-Factory）" class="headerlink" title="从简单工厂开始（Simple Factory）"></a>从简单工厂开始（Simple Factory）</h2><p>先上代码：<br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ComputerStore</span></div><div class="line">&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> Computer <span class="title">BuyComputer</span>(<span class="params"><span class="keyword">double</span> money</span>)</span></div><div class="line">    &#123;</div><div class="line">        Computer pc = <span class="keyword">new</span> Computer();</div><div class="line">        <span class="keyword">if</span> (money &gt; <span class="number">6000</span>)</div><div class="line">        &#123;</div><div class="line">            pc = <span class="keyword">new</span> Computer();</div><div class="line">            pc.CPU = <span class="string">"I7 6700K"</span>;</div><div class="line">            pc.GPU = <span class="string">"GTX970"</span>;</div><div class="line">            pc.Mainboard = <span class="string">"Z170"</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">else</span> <span class="title">if</span> (<span class="params">money &gt; <span class="number">4000</span></span>)</span></div><div class="line">        &#123;</div><div class="line">            pc = <span class="keyword">new</span> Computer();</div><div class="line">            pc.CPU = <span class="string">"I5 6600K"</span>;</div><div class="line">            pc.GPU = <span class="string">"GTX960"</span>;</div><div class="line">            pc.Mainboard = <span class="string">"B150"</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span></div><div class="line">        &#123;</div><div class="line">            pc = <span class="keyword">new</span> Computer();</div><div class="line">            pc.CPU = <span class="string">"I5 6500"</span>;</div><div class="line">            pc.GPU = <span class="string">"GTX950"</span>;</div><div class="line">            pc.Mainboard = <span class="string">"B150"</span>;</div><div class="line">        &#125;</div><div class="line">        InstallOS(pc);</div><div class="line">        InstallApp(pc);</div><div class="line">        DoSomeTest(pc);</div><div class="line">        <span class="keyword">return</span> pc;</div><div class="line">    &#125;</div><div class="line">    InstallOS(Computer pc) &#123; ... &#125;</div><div class="line">    InstallApp(Computer pc) &#123; ... &#125;</div><div class="line">    DoSomeTest(Computer pc) &#123; ... &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>我们几乎可以自然而然的想到，把创建Computer对象及初始化的的代码给拿出来，因为由于配件价格的变动，装配方案是会经常调整的，比如现在Intel出了7代CPU，6000价位以上便可配I7 7700K了，我们把它改成一个有模有样的工厂：<br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ComputerStore</span></div><div class="line">&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> Computer <span class="title">BuyComputer</span>(<span class="params"><span class="keyword">double</span> money</span>)</span></div><div class="line">    &#123;</div><div class="line">        Computer pc = AssembleComputer(money); <span class="comment">//把组装电脑的代码放到了一个单独的类里头</span></div><div class="line">        InstallOS(pc);</div><div class="line">        InstallApp(pc);</div><div class="line">        DoSomeTest(pc);</div><div class="line">        <span class="keyword">return</span> pc;</div><div class="line">    &#125;</div><div class="line">    InstallOS(Computer pc) &#123; ... &#125;</div><div class="line">    InstallApp(Computer pc) &#123; ... &#125;</div><div class="line">    DoSomeTest(Computer pc) &#123; ... &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ComputerAssembleFactory</span> <span class="comment">//组装工厂，称之为组装间会合适点，这里只是为了有模有样</span></div><div class="line">&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">AssembleComputer</span>(<span class="params"><span class="keyword">double</span> money</span>)</span></div><div class="line">    &#123;</div><div class="line">        Computer pc = <span class="keyword">new</span> Computer();</div><div class="line">        <span class="keyword">if</span> (money &gt; <span class="number">6000</span>)</div><div class="line">        &#123;</div><div class="line">            pc = <span class="keyword">new</span> Computer();</div><div class="line">            pc.CPU = <span class="string">"I7 6700K"</span>;</div><div class="line">            pc.GPU = <span class="string">"GTX970"</span>;</div><div class="line">            pc.Mainboard = <span class="string">"Z170"</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">else</span> <span class="title">if</span> (<span class="params">money &gt; <span class="number">4000</span></span>)</span></div><div class="line">        &#123;</div><div class="line">            pc = <span class="keyword">new</span> Computer();</div><div class="line">            pc.CPU = <span class="string">"I5 6600K"</span>;</div><div class="line">            pc.GPU = <span class="string">"GTX960"</span>;</div><div class="line">            pc.Mainboard = <span class="string">"B150"</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span></div><div class="line">        &#123;</div><div class="line">            pc = <span class="keyword">new</span> Computer();</div><div class="line">            pc.CPU = <span class="string">"I5 6500"</span>;</div><div class="line">            pc.GPU = <span class="string">"GTX950"</span>;</div><div class="line">            pc.Mainboard = <span class="string">"B150"</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> pc;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>我们可以这样理解，ComputerStore的关注点在于电脑的销售，拿着价格单配置单面对客户就行了，至于这个价钱是买5代I7还是6代I7，还有零件的装配啥的，交给组装间就行了。<br>我们使用一个对象时，并不关心它是怎么造出来的，制造流程的变化，不应该影响我使用。简单工厂目的在于把类的构造及初始化的逻辑，封装到一起，让一个类<strong>只有一个被修改的理由</strong>。当然其实并不是非得某某Factory的才是工厂，像Encoding类的<br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> encoding = Encoding.GetEncoding(<span class="string">"UTF8"</span>);</div></pre></td></tr></table></figure></p>
<p>,就是简单工厂的体现。</p>
<h2 id="抽象工厂模式（Factory-Method）"><a href="#抽象工厂模式（Factory-Method）" class="headerlink" title="抽象工厂模式（Factory Method）"></a>抽象工厂模式（Factory Method）</h2><p>简单工厂简单粗暴，代码写多了自然而然能够想得到，但是，简单工厂虽然能够更好的应对<strong>修改</strong>，却不足以应对<strong>扩展</strong>。<br>想象一下，我们要开另外一家电脑店，别的都一样，但是改用AMD的CPU。<br>既然是OO程序员，我们就不能简单粗暴的Copy一份代码，改一下类名，然后就改一下那一个方法。<br>研究一下可以发现，如果我们让所有的Factory都继承自同一个基类，基类实现一个AssembleComputer的抽象方法，这样ComputerStore便可使用各式各样的Factory了，更改如下：<br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ComputerStore</span></div><div class="line">&#123;</div><div class="line">    AssembleFactory factory;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ComputerStore</span>(<span class="params">AssembleFactory factory</span>) <span class="comment">//工厂从构造函数里头传入</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">this</span>.factory=factory;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> Computer <span class="title">BuyComputer</span>(<span class="params"><span class="keyword">double</span> money</span>)</span></div><div class="line">    &#123;</div><div class="line">        Computer pc =factory.AssembleComputer(money); </div><div class="line">        InstallOS(pc);</div><div class="line">        InstallApp(pc);</div><div class="line">        DoSomeTest(pc);</div><div class="line">        <span class="keyword">return</span> pc;</div><div class="line">    &#125;</div><div class="line">    InstallOS(Computer pc) &#123; ... &#125;</div><div class="line">    InstallApp(Computer pc) &#123; ... &#125;</div><div class="line">    DoSomeTest(Computer pc) &#123; ... &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">IntelComputerAssembleFactory</span> : <span class="title">AssembleFactory</span> <span class="comment">//专业组装Intel主机</span></div><div class="line">&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span>  Computer <span class="title">AssembleComputer</span>(<span class="params"><span class="keyword">double</span> money</span>)</span></div><div class="line">    &#123;</div><div class="line">        Computer pc = <span class="keyword">new</span> Computer();</div><div class="line">        <span class="keyword">if</span> (money &gt; <span class="number">6000</span>)</div><div class="line">        &#123;</div><div class="line">            pc = <span class="keyword">new</span> Computer();</div><div class="line">            pc.CPU = <span class="string">"I7 6700K"</span>;</div><div class="line">            pc.GPU = <span class="string">"GTX970"</span>;</div><div class="line">            pc.Mainboard = <span class="string">"Z170"</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">else</span> <span class="title">if</span> (<span class="params">money &gt; <span class="number">4000</span></span>)</span></div><div class="line">        &#123;</div><div class="line">            pc = <span class="keyword">new</span> Computer();</div><div class="line">            pc.CPU = <span class="string">"I5 6600K"</span>;</div><div class="line">            pc.GPU = <span class="string">"GTX960"</span>;</div><div class="line">            pc.Mainboard = <span class="string">"B150"</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span></div><div class="line">        &#123;</div><div class="line">            pc = <span class="keyword">new</span> Computer();</div><div class="line">            pc.CPU = <span class="string">"I5 6500"</span>;</div><div class="line">            pc.GPU = <span class="string">"GTX950"</span>;</div><div class="line">            pc.Mainboard = <span class="string">"B150"</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> pc;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">AMDComputerAssembleFactory</span> : <span class="title">AssembleFactory</span> <span class="comment">//专业组装AMD主机</span></div><div class="line">&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> Computer <span class="title">AssembleComputer</span>(<span class="params"><span class="keyword">double</span> money</span>)</span></div><div class="line">    &#123;</div><div class="line">        Computer pc = <span class="keyword">new</span> Computer();</div><div class="line">        <span class="keyword">if</span> (money &gt; <span class="number">6000</span>)</div><div class="line">        &#123;</div><div class="line">            pc = <span class="keyword">new</span> Computer();</div><div class="line">            pc.CPU = <span class="string">"AMD Ryzen 7 1700"</span>;</div><div class="line">            pc.GPU = <span class="string">"GTX970"</span>;</div><div class="line">            pc.Mainboard = <span class="string">"XXX"</span>;<span class="comment">//AMD平台不熟悉。。</span></div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">else</span> <span class="title">if</span> (<span class="params">money &gt; <span class="number">4000</span></span>)</span></div><div class="line">        &#123;</div><div class="line">            pc = <span class="keyword">new</span> Computer();</div><div class="line">            pc.CPU = <span class="string">"XXX"</span>;</div><div class="line">            pc.GPU = <span class="string">"GTX960"</span>;</div><div class="line">            pc.Mainboard = <span class="string">"XXX"</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span></div><div class="line">        &#123;</div><div class="line">            pc = <span class="keyword">new</span> Computer();</div><div class="line">            pc.CPU = <span class="string">"XXX"</span>;</div><div class="line">            pc.GPU = <span class="string">"GTX950"</span>;</div><div class="line">            pc.Mainboard = <span class="string">"XXX"</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> pc;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title">AssembleFactory</span> <span class="comment">//不同工厂的基类，这样ComputerStore并不需要知道具体是哪一种工厂</span></div><div class="line">&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> Computer <span class="title">AssembleComputer</span>(<span class="params"><span class="keyword">double</span> money</span>)</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>现在，通过ComputerStore组合不同的Factory，就可以有不同的电脑店：<br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> intelFactory = <span class="keyword">new</span> IntelComputerAssembleFactory();</div><div class="line"><span class="keyword">var</span> intelComputerStore=<span class="keyword">new</span> ComputerStore(intelFactory);</div><div class="line"></div><div class="line"><span class="keyword">var</span> amdFactory = <span class="keyword">new</span> AMDComputerAssembleFactory();</div><div class="line"><span class="keyword">var</span> amdComputerStore=<span class="keyword">new</span> ComputerStore(amdFactory);</div></pre></td></tr></table></figure></p>
<p>任务完成，实现了扩展， ComputerStore的代码得到了复用。这就是传说中的抽象工厂模式，<strong>抽象工厂模式提供一个接口，用于创建相关的一个对象或者一组对象，而不需要明确指定具体类。</strong>  用户类（ComputerStore)只依赖抽象工厂类（AssembleFactory），并不依赖于具体的工厂类（IntelComputerAssembleFactory），符合OO设计原则：<strong>要依赖抽象，不要依赖具体类。</strong>  </p>
<h2 id="工厂方法模式（Abstract-Factory）"><a href="#工厂方法模式（Abstract-Factory）" class="headerlink" title="工厂方法模式（Abstract Factory）"></a>工厂方法模式（Abstract Factory）</h2><p>上面的代码我们还能改得优雅一些：<br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title">ComputerStore</span></div><div class="line">&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> Computer <span class="title">BuyComputer</span>(<span class="params"><span class="keyword">double</span> money</span>)</span></div><div class="line">    &#123;</div><div class="line">        Computer pc = AssembleComputer(money); </div><div class="line">        InstallOS(pc);</div><div class="line">        InstallApp(pc);</div><div class="line">        DoSomeTest(pc);</div><div class="line">        <span class="keyword">return</span> pc;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> Computer <span class="title">AssembleComputer</span>(<span class="params"><span class="keyword">double</span> money</span>)</span>; <span class="comment">//原来工厂类基类里的方法，现在放到了ComputerStore类里作为一个抽象方法留给子类实现</span></div><div class="line">    </div><div class="line">    InstallOS(Computer pc) &#123; ... &#125;</div><div class="line">    InstallApp(Computer pc) &#123; ... &#125;</div><div class="line">    DoSomeTest(Computer pc) &#123; ... &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">IntelComputerStore</span> : <span class="title">ComputerStore</span> <span class="comment">//Intel电脑店，实现了自己的AssembleComputer方法</span></div><div class="line">&#123;</div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> Computer <span class="title">AssembleComputer</span>(<span class="params"><span class="keyword">double</span> money</span>)</span></div><div class="line">    &#123;</div><div class="line">        Computer pc = <span class="keyword">new</span> Computer();</div><div class="line">        <span class="keyword">if</span> (money &gt; <span class="number">6000</span>)</div><div class="line">        &#123;</div><div class="line">            pc = <span class="keyword">new</span> Computer();</div><div class="line">            pc.CPU = <span class="string">"I7 6700K"</span>;</div><div class="line">            pc.GPU = <span class="string">"GTX970"</span>;</div><div class="line">            pc.Mainboard = <span class="string">"Z170"</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">else</span> <span class="title">if</span> (<span class="params">money &gt; <span class="number">4000</span></span>)</span></div><div class="line">        &#123;</div><div class="line">            pc = <span class="keyword">new</span> Computer();</div><div class="line">            pc.CPU = <span class="string">"I5 6600K"</span>;</div><div class="line">            pc.GPU = <span class="string">"GTX960"</span>;</div><div class="line">            pc.Mainboard = <span class="string">"B150"</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span></div><div class="line">        &#123;</div><div class="line">            pc = <span class="keyword">new</span> Computer();</div><div class="line">            pc.CPU = <span class="string">"I5 6500"</span>;</div><div class="line">            pc.GPU = <span class="string">"GTX950"</span>;</div><div class="line">            pc.Mainboard = <span class="string">"B150"</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> pc;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">AMDComputerStore</span> : <span class="title">ComputerStore</span> <span class="comment">//AMD电脑店，实现了自己的AssembleComputer方法</span></div><div class="line">&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> Computer <span class="title">AssembleComputer</span>(<span class="params"><span class="keyword">double</span> money</span>)</span></div><div class="line">    &#123;</div><div class="line">        Computer pc = <span class="keyword">new</span> Computer();</div><div class="line">        <span class="keyword">if</span> (money &gt; <span class="number">6000</span>)</div><div class="line">        &#123;</div><div class="line">            pc = <span class="keyword">new</span> Computer();</div><div class="line">            pc.CPU = <span class="string">"AMD Ryzen 7 1700"</span>;</div><div class="line">            pc.GPU = <span class="string">"GTX970"</span>;</div><div class="line">            pc.Mainboard = <span class="string">"XXX"</span>;<span class="comment">//AMD平台不熟悉。。</span></div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">else</span> <span class="title">if</span> (<span class="params">money &gt; <span class="number">4000</span></span>)</span></div><div class="line">        &#123;</div><div class="line">            pc = <span class="keyword">new</span> Computer();</div><div class="line">            pc.CPU = <span class="string">"XXX"</span>;</div><div class="line">            pc.GPU = <span class="string">"GTX960"</span>;</div><div class="line">            pc.Mainboard = <span class="string">"XXX"</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span></div><div class="line">        &#123;</div><div class="line">            pc = <span class="keyword">new</span> Computer();</div><div class="line">            pc.CPU = <span class="string">"XXX"</span>;</div><div class="line">            pc.GPU = <span class="string">"GTX950"</span>;</div><div class="line">            pc.Mainboard = <span class="string">"XXX"</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> pc;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>这样是不是优雅很多了呢，我们看不到乱七八糟的Factory了，Intel电脑店对应IntelComputerStore，AMD电脑店对应AMDComputerStore,相当自然，效果还是一样的，ComputerStore里的代码得到了复用，所有的修改和扩展都只需要修改ComputerStore的子类。<br><strong>工厂方法模式定义了一个创建对象的接口，留给子类实现，把对象的实例化推迟到了子类。</strong><br>其实抽象工厂模式中，抽象工厂的具体实现，就相当于工厂方法模式，父类定义创建的接口，子类定义具体实现。不过抽象工厂可以有一组创建对象的接口，这些对象都是相关的，工厂方法则没有这个效果。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>《Head First 设计模式》里花了很大的篇幅讲解工厂模式，例子、插图、疑难解答等，概括地说，简单工厂封装了创建对象的代码以应对修改；抽象工厂模式定义了创建对象的接口，让使用对象的逻辑和具体对象以及创建对象的逻辑解耦（<strong>依赖倒置原则</strong>）；工厂方法模式定义接口，将对象的创建交给子类。抽象工厂模式通过组合来实现复用，工厂方法模式则是通过继承来实现。  .NET Framework中也有不少工厂模式范例，比如WebRequest类（工厂方法），DbProviderFactory（抽象工厂）等，这里就不详细讨论了。</p>
<p>本文的例子可能不是太好，这只是我自己的理解，仅供参考。</p>


  </article>
  </script>
    <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
  </script>
  <div class="busuanzi center">
    页阅读量:&nbsp;<span id="busuanzi_value_page_pv"></span>&nbsp;・&nbsp;
    站访问量:&nbsp;<span id="busuanzi_value_site_pv"></span>&nbsp;・&nbsp;
    站访客数:&nbsp;<span id="busuanzi_value_site_uv"></span>
  </div>




    </div>
  </div>
  <footer class="page-footer"><div class="clearfix">
</div>
<div class="right-foot container">
    <div class="firstrow">
        <a href="#top" target="_self">
        <i class="fa fa-arrow-right"></i>
        </a>
        © Vachel 2016-2017
    </div>
    <div class="secondrow">
        <a href="https://github.com/Wenqihai">
        Vachel
        </a>
    </div>
</div>
<div class="clearfix">
</div>
</footer>
  <script src="//cdn.bootcss.com/jquery/2.2.1/jquery.min.js"></script>
<script src="/js/search.js"></script>
<script type="text/javascript">

// disqus scripts


// dropdown scripts
$(".dropdown").click(function(event) {
  var current = $(this);
  event.stopPropagation();
  $(current).children(".dropdown-content")[($(current).children(".dropdown-content").hasClass("open"))?'removeClass':'addClass']("open")
});
$(document).click(function(){
    $(".dropdown-content").removeClass("open");
})

var path = "/search.xml";
searchFunc(path, 'local-search-input', 'local-search-result');

</script>

</body>
</html>
